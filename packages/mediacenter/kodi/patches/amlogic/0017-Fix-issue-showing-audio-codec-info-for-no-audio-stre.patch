From 2bf5e9fbd5b30cc492e18a6e690de914de87cb45 Mon Sep 17 00:00:00 2001
From: afl1 <afl2001@gmail.com>
Date: Wed, 7 Aug 2019 04:04:39 +0100
Subject: [PATCH 17/43] Fix issue showing audio codec info for no audio
 streams.

Patch: kodi-le-046-fix-audio-codec-info.patch
---
 xbmc/cores/VideoPlayer/VideoPlayerAudio.cpp | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/xbmc/cores/VideoPlayer/VideoPlayerAudio.cpp b/xbmc/cores/VideoPlayer/VideoPlayerAudio.cpp
index c56aa60..3c88b02 100644
--- a/xbmc/cores/VideoPlayer/VideoPlayerAudio.cpp
+++ b/xbmc/cores/VideoPlayer/VideoPlayerAudio.cpp
@@ -108,7 +108,6 @@ void CVideoPlayerAudio::OpenStream(CDVDStreamInfo &hints, CDVDAudioCodec* codec)
   SAFE_DELETE(m_pAudioCodec);
   m_pAudioCodec = codec;
 
-  m_processInfo.ResetAudioCodecInfo();
 
   /* store our stream hints */
   m_streaminfo = hints;
@@ -186,6 +185,16 @@ void CVideoPlayerAudio::CloseStream(bool bWaitForBuffers)
     delete m_pAudioCodec;
     m_pAudioCodec = NULL;
   }
+
+  std::ostringstream s;
+  SInfo info;
+  info.info        = s.str();
+  info.pts         = DVD_NOPTS_VALUE;
+  info.passthrough = false;
+
+  { CSingleLock lock(m_info_section);
+    m_info = info;
+  }
 }
 
 void CVideoPlayerAudio::OnStartup()
-- 
2.7.4

